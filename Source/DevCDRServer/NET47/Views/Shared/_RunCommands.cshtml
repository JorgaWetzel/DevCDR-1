<script type="text/javascript">
    function Command(param, args) {
        var table = $('#test').DataTable();
        if (args == null) { args = "" };
        var rowdata = JSON.stringify(table.rows({ selected: true }).data().toArray());
        $.ajax({
            type: 'post',
            url: '@Url.Action("Command")',
            data: '{ "command": "' + param + '", "instance" : "@ViewData["Instance"].ToString()", "args": "' + args + '", "rows": ' + rowdata + '  }',
            contentType: 'application/json; charset=utf-8',
            dataType: "json",
        })
    }

    function RunPS(param,title) {
        var table = $('#test').DataTable();
        var rowdata = JSON.stringify(table.rows({ selected: true }).data().toArray());
        if (param == null) { param = psScript.value }
        if (title == null) { title = "CustomPS" }
        $.ajax({
            type: 'post',
            url: '@Url.Action("RunPS")',
            data: '{ "psscript": "' + encodeURIComponent(param) + '", "title" : "' + title + '", "instance" : "@ViewData["Instance"].ToString()", "rows": ' + rowdata + '  }',
            contentType: 'application/json; charset=utf-8',
            dataType: "json",
        })
    }
</script>
